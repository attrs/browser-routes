/*! browser-routes v0.0.3 attrs */!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("Routes",[],r):"object"==typeof exports?exports.Routes=r():t.Routes=r()}(this,function(){return function(t){function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var e={};return r.m=t,r.c=e,r.p="",r(0)}([function(t,r,e){function n(t,r){if(!t||"string"!=typeof t)throw new TypeError("illegal url");var e=(r||document).createElement("a");return e.href=t,{href:e.href,protocol:e.protocol,hostname:e.hostname,port:e.port,pathname:e.pathname,fullpath:e.pathname+(e.search?e.search:"")+(e.hash?e.hash:""),search:e.search,hash:e.hash,host:e.host}}function o(t,r){var e=document.head.querySelector('meta[name="'+t+'"][content]');return e&&e.getAttribute("content")||r}function i(t){t=t.trim(),"?"===t[0]&&(t=t.substring(1));for(var r,e=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(e," "))},i={};r=n.exec(t);){var u=o(r[1]),s=o(r[2]);Array.isArray(i[u])?i[u].push(s):i[u]?(i[u]=[i[u]]).push(s):i[u]=s}return i}function u(t,r,e,n){t.attachEvent?t.attachEvent(r,e):t.addEventListener(r,e,n)}function s(t,r){return t===r}function f(t,r,e,n,o){var i,u=0;return i=function(s){var f=n[u++];if(s||!f)return o(s);var c=f.uri,h=f.type,a=f.fn;if("use"===h&&c){c&&"/"===c.trim()&&(c="");var p=r.purl||"",d=r.url;r.purl=l.join(p,d.substring(0,c.length)),r.url=d.substring(c.length)||"/",a.apply(t,[r,e,i]),r.purl=p,r.url=d}else a.apply(t,[r,e,i])}}function c(t){return function(r,e,n){e.redirect(t)}}function h(t){t=t||"unknwon";var r=!0,e=[],n={},o=function(t,n,i){i=i||function(){};var u=[];e.forEach(function(e){if(r||!e.boot)if("use"===e.type){if("/"===e.uri||!t.url.indexOf(e.uri)||s(t.url,e.uri))return u.push(e)}else if("get"===e.type&&s(t.url,e.uri))return u.push(e)}),t.boot=r,f(o,t,n,u,i)(t.error),r=!1};return o.exists=function(t){var r=!1;return e.forEach(function(e){if("get"===e.type&&s(t,e.uri))return r=!0;if("use"===e.type&&e.uri&&!t.indexOf(e.uri)){if("function"!=typeof e.fn.exists)return r=s(t,e.uri);r=e.fn.exists(t.substring(e.uri.length))}}),r},o.use=function(t,r){if("function"==typeof t&&(r=t,t=null),t&&"string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("string"==typeof r&&(r=c(r)),"function"!=typeof r)throw new TypeError("illegal type of router:"+typeof r);return t=t?t.trim():"/","/"!==t[0]&&(t="/"+t),e.push({type:"use",uri:t,fn:r}),this},o.get=function(t,r){if("string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("string"==typeof r&&(r=c(r)),"function"!=typeof r)throw new TypeError("illegal type of router:"+typeof r);return t=t?t.trim():"/","/"!==t[0]&&(t="/"+t),e.push({type:"get",uri:t,fn:r}),this},o.boot=function(t){if("function"!=typeof t)throw new TypeError("illegal type of router:"+typeof t);return e.push({type:"use",boot:!0,fn:t}),this},o.notfound=function(t){return o.on("notfound",t),this},o.error=function(t){return o.on("error",t),this},o.drop=function(t){var r=[];return e.forEach(function(e){e.fn===t&&r.push(e)}),r.forEach(function(t){e.splice(e.indexOf(t),1)}),this},o.clear=function(){return e=[],this},o.on=function(t,r){return n[t]=n[t]||[],n[t].push(r),this},o.once=function(t,r){var e=function(n){return o.off(t,e),r.call(this,n)};return o.on(t,e),this},o.off=function(t,r){var e=n[t];if(e)for(var o;~(o=e.indexOf(r));)e.splice(o,1);return this},o.fire=function(t,r){return"error"!==t||n[t]&&isteners[t].length?void(n[t]||[]).forEach(function(e){e.call(this,{type:t,detail:r||{}})}):console.error("[routes] error",r)},o}function a(t){if(!(this instanceof a))throw new Error("illegal state: 'new Routes()' instead of 'Routes()'");t=t||{};var r,e,o,u="",s=h("root");this.config=function(r,e){var n=t;return 1===arguments.length?n(r):(null===e?delete n[r]:n[r]=e,this)},this.base=function(t){return arguments.length?t?(u=l.dirname(l.resolve(t,"index.html")),this):(u="",this):u},this.router=function(t){return h(t)},this.normalize=function(t){return t=t.trim(),t?"/"===t[0]?u+t:n(t).fullpath:u};var f=this.exec=function(t){var c=n(t),h=c.hash,a=c.search,p=c.pathname,d=c.fullpath;if(!r||!r.requestURL||d!==r.requestURL){if(u&&p.startsWith(u))p=p.substring(u.length);else if(u)return console.error("given url is not a sub url of base url '"+u+"'");return o=[],r={method:"get",parsed:c,baseURL:u,requestURL:d,url:p,hashname:h,query:i(a),params:{}},e={redirect:function(t){return t.startsWith("#")?location.href=t:f(t.startsWith("/")?l.join(u,t):l.join(u,r.purl,r.url,t)),s.fire("redirect",{requestURL:d,url:p,request:r,response:e}),this},hash:function(t,r){o.push({hash:t,fn:r})}},s.fire("request",{requestURL:d,url:p,request:r,response:e}),s(r,e),this}};this.exechash=function(){return this},this.use=function(t,r){return s.use.apply(s,arguments),this},this.boot=function(t){return s.boot(t),this},this.get=function(t,r){return s.get(t,r),this},this.notfound=function(t){return s.notfound(t),this},this.error=function(t){return s.error(t),this},this.drop=function(t){return s.drop(t),this},this.exists=function(t){return s.exists(t)},this.clear=function(){return s.clear(),this},this.on=function(t,r){return s.on(t,r),this},this.once=function(t,r){return s.once(t,r),this},this.off=function(t,r){return s.off(t,r),this}}var l=e(1),p=new a;p.Routes=a,p.Router=h,function(){function t(){function t(t){return t.__routes_managed__||(t.__routes_managed__=!0,u(t,"click",function(r){r.preventDefault(),p.href(t.getAttribute("href"))})),this}function r(){return[].forEach.call(document.querySelectorAll("[routes], [data-routes]"),t),this}i&&i.disconnect(),i=new MutationObserver(function(r){r.forEach(function(r){[].forEach.call(r.addedNodes,function(r){1===r.nodeType&&(r.hasAttribute("routes")&&t(r),r.hasAttribute("data-routes")&&t(r),r.querySelectorAll&&[].forEach.call(r.querySelectorAll("[routes], [data-routes]"),t))})})}),i.observe(document.body,{childList:!0,subtree:!0}),r(),p.exec(location.href)}var r=o("routes.mode")||(history.pushState?"pushstate":"hash");if("pushstate"===r){if(!history.pushState)return console.error("[routes] unsupported 'history.pushState'");var e=history.pushState;history.pushState=function(t,r,n){e.apply(history,arguments),p.exec(location.href)},window.onpopstate=function(t){p.exec(location.href)},p.on("request",function(t){n(location.href).fullpath!==n(t.detail.requestURL).fullpath&&e.call(history,null,null,t.detail.requestURL)}),p.href=function(t){history.pushState(null,null,p.normalize(t))}}else if("hash"===r){if(!("onhashchange"in window))return console.error("[routes] unsupported 'onhashchange'");u(window,"hashchange",function(){p.exec(location.hash)}),p.on("redirect",function(t){location.href="#"+t.detail.url}),p.href=function(t){location.href="#"+p.normalize(t)}}var i;document.body?t():u(document,"DOMContentLoaded",t)}(),t.exports=p},function(t,r,e){(function(t){function e(t,r){for(var e=0,n=t.length-1;n>=0;n--){var o=t[n];"."===o?t.splice(n,1):".."===o?(t.splice(n,1),e++):e&&(t.splice(n,1),e--)}if(r)for(;e--;e)t.unshift("..");return t}function n(t,r){if(t.filter)return t.filter(r);for(var e=[],n=0;n<t.length;n++)r(t[n],n,t)&&e.push(t[n]);return e}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return o.exec(t).slice(1)};r.resolve=function(){for(var r="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var u=i>=0?arguments[i]:t.cwd();if("string"!=typeof u)throw new TypeError("Arguments to path.resolve must be strings");u&&(r=u+"/"+r,o="/"===u.charAt(0))}return r=e(n(r.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+r||"."},r.normalize=function(t){var o=r.isAbsolute(t),i="/"===u(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&i&&(t+="/"),(o?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t,r){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var r=0;r<t.length&&""===t[r];r++);for(var e=t.length-1;e>=0&&""===t[e];e--);return r>e?[]:t.slice(r,e-r+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var o=n(t.split("/")),i=n(e.split("/")),u=Math.min(o.length,i.length),s=u,f=0;u>f;f++)if(o[f]!==i[f]){s=f;break}for(var c=[],f=s;f<o.length;f++)c.push("..");return c=c.concat(i.slice(s)),c.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var r=i(t),e=r[0],n=r[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},r.basename=function(t,r){var e=i(t)[2];return r&&e.substr(-1*r.length)===r&&(e=e.substr(0,e.length-r.length)),e},r.extname=function(t){return i(t)[3]};var u="b"==="ab".substr(-1)?function(t,r,e){return t.substr(r,e)}:function(t,r,e){return 0>r&&(r=t.length+r),t.substr(r,e)}}).call(r,e(2))},function(t,r){function e(){a&&c&&(a=!1,c.length?h=c.concat(h):l=-1,h.length&&n())}function n(){if(!a){var t=u(e);a=!0;for(var r=h.length;r;){for(c=h,h=[];++l<r;)c&&c[l].run();l=-1,r=h.length}c=null,a=!1,s(t)}}function o(t,r){this.fun=t,this.array=r}function i(){}var u,s,f=t.exports={};!function(){try{u=setTimeout}catch(t){u=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(t){s=function(){throw new Error("clearTimeout is not defined")}}}();var c,h=[],a=!1,l=-1;f.nextTick=function(t){var r=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)r[e-1]=arguments[e];h.push(new o(t,r)),1!==h.length||a||u(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=i,f.addListener=i,f.once=i,f.off=i,f.removeListener=i,f.removeAllListeners=i,f.emit=i,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}}])});