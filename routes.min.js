!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=e():this.Routes=e()}(this,function(){function t(t,e){return t===e}function e(t){for(var e,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(n," "))},i={};e=r.exec(t);){var u=o(e[1]),s=o(e[2]);Array.isArray(i[u])?i[u].push(s):i[u]?(i[u]=[i[u]]).push(s):i[u]=s}return i}function n(){var t=document.currentScript||document._currentScript;return function(){return t&&t.ownerDocument&&t.ownerDocument.documentElement&&t.ownerDocument.documentElement.contains(t)}}function r(t,e,n,r){var o,i=0;return o=function(u){var s=n[i++];if(!s)return r(u);var f=s.uri,c=s.type,h=s.fn,a=!f&&h.length>2;if(u&&a)e.error=u,h.apply(t,[u,e,o]);else if(a)o(e.error);else if("use"===c&&f){var l=e.baseUrl,p=e.url;e.baseUrl=f.substring(0,f.length),e.url=e.url.substring(f.length)||"",h.apply(t,[e,o]),e.baseUrl=l,e.url=p}else h.apply(t,[e,o])}}function o(){var e=!0,o=[],i={},u=function(n,i){i=i||function(){};var s=[],f=[];o.forEach(function(e){return e.checker&&!e.checker()?f.push(e):"use"!==e.type||e.uri&&n.url.indexOf(e.uri)?"get"===e.type&&t(n.url,e.uri)?s.push(e):void 0:s.push(e)}),f.forEach(function(t){o.splice(o.indexOf(t),1)}),n.boot=e,r(u,n,s,i)(n.error),e=!1};return u.exists=function(e){var n=!1;return o.forEach(function(r){if(!r.checker||r.checker()){if("get"===r.type&&t(e,r.uri))return n=!0;if("use"===r.type&&r.uri&&!e.indexOf(r.uri)){if("function"!=typeof r.fn.exists)return n=t(e,r.uri);n=r.fn.exists(e.substring(r.uri.length))}}}),n},u.use=function(t,e,r){if("function"==typeof t&&(r=e,e=t,t=null),t&&"string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("function"!=typeof e)throw new TypeError("illegal type of router:"+typeof e);return o.push({type:"use",uri:t,fn:e,checker:r||n()}),this},u.get=function(t,e,r){if("string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("function"!=typeof e)throw new TypeError("illegal type of router:"+typeof e);return o.push({type:"get",uri:t,fn:e,checker:r||n()}),this},u.notfound=function(t){},u.drop=function(t){var e=[];return o.forEach(function(n){n.fn===t&&e.push(n)}),e.forEach(function(t){o.splice(o.indexOf(t),1)}),this},u.clear=function(){return o=[],this},u.on=function(t,e){return i[t]=i[t]||[],i[t].push(e),this},u.once=function(t,e){var n=function(r){return u.off(t,n),e.call(this,r)};return u.on(t,n),this},u.off=function(t,e){var n=i[t];if(n)for(var r;~(r=n.indexOf(e));)n.splice(r,1);return this},u}function i(t){if(!(this instanceof i))throw new Error("illegal state: Routes must be instantiated");t=t||{};var n,r,s=o();this.config=function(e,n){var r=t;return 1===arguments.length?r(e):(null===n?delete r[e]:r[e]=n,this)},this.router=function(){return o()};var f;this.href=function(t){return arguments.length?(t=u(t),f===t.href?this:(n=t.href,this.exec(),this)):f||location.href},this.exec=function(){var t=u(this.href());r=[];var o=n={method:"get",parsed:t,url:t.href,originalUrl:t.pathname,baseUrl:"/",url:t.pathname,hashname:t.hash,query:e(t.search),hash:function(t,e){r.push({hash:t,fn:e})},params:{}};return s(o,function(t){return t?console.error(t):void 0}),this},this.exechash=function(){return this},this.use=function(t,e){return s.use.apply(s,arguments),this},this.get=function(t,e){return s.get(t,e),this},this.notfound=function(t){return s.notfound(t),this},this.drop=function(t){return s.drop(t),this},this.exists=function(t){return s.exists(t)},this.clear=function(){return s.clear(),this},this.on=function(t,e){return s.on(t,e),this},this.once=function(t,e){return s.once(t,e),this},this.off=function(t,e){return s.off(t,e),this}}var u=function(t,e){var n=(e||document).createElement("a");return n.href=t,{href:t,protocol:n.protocol,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search,hash:n.hash,host:n.host}},s=function(t,e){var n=document.head.querySelector('meta[name="'+t+'"][content]');return n&&n.getAttribute("content")||e},f=document.baseURI;console.log("baseUrl",f);var c=function(){function t(t){return t.__routes_managed__||(t.__routes_managed__=!0,f(t,"click",function(e){if(t.hasAttribute("data-prevent"))return e.preventDefault();var n=t.getAttribute("href");if(n&&!~n.indexOf("://")&&n.toLowerCase().indexOf("javascript:")&&!t.getAttribute("target")&&(i||r.exists(t.pathname)))if(e.preventDefault(),"hash"===u)location.href="#"+t.href;else{if(location.href===t.href)return;history.pushState({},null,t.href)}})),this}function e(){return[].forEach.call(document.querySelectorAll("[routes], [data-routes]"),t),this}function n(){o&&o.disconnect(),o=new MutationObserver(function(e){e.forEach(function(e){[].forEach.call(e.addedNodes,function(e){1===e.nodeType&&(e.hasAttribute("routes")&&t(e),e.hasAttribute("data-routes")&&t(e),e.querySelectorAll&&[].forEach.call(e.querySelectorAll("[routes], [data-routes]"),t))})})}),o.observe(document.body,{childList:!0,subtree:!0}),e(),c.href(location.href)}if(!("onhashchange"in window))return console.error("[routes] unsupported browser");var r,o,i="true"===s("routes.always"),u=s("routes.mode")||"pushstate",f=function(t,e,n,r){t.attachEvent?t.attachEvent(e,n):t.addEventListener(e,n,r)};if(history.pushState){var h=history.pushState;history.pushState=function(t,e,n){h.apply(history,arguments),r&&r.href(location.href)},window.onpopstate=function(t){r&&r.href(location.href)}}return"onhashchange"in window&&f(window,"hashchange",function(){var t=location.hash;console.log("hash",t),r&&r.href(location.hash)}),document.body?n():f(document,"DOMContentLoaded",n),{context:function(t){return arguments.length?(r=t,this):r},href:function(t){return r&&r.href(t),this},scan:e,observer:function(){return o}}}(),h=new i;return h.Routes=i,h.trigger=c,c.context(h),h});