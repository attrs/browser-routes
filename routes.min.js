!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=e():this.Routes=e()}(this,function(){function t(t,e){return t===e}function e(t){return"hash"===t?location.hash:location.href}function n(t){for(var e,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(n," "))},i={};e=r.exec(t);){var u=o(e[1]),s=o(e[2]);Array.isArray(i[u])?i[u].push(s):i[u]?(i[u]=[i[u]]).push(s):i[u]=s}return i}function r(){var t=document.currentScript||document._currentScript;return function(){return t&&t.ownerDocument&&t.ownerDocument.documentElement&&t.ownerDocument.documentElement.contains(t)}}function o(t,e,n,r){var o,i=0;return o=function(u){var s=n[i++];if(!s)return r(u);var f=s.uri,h=s.type,c=s.fn,a=!f&&c.length>2;if(u&&a)e.error=u,c.apply(t,[u,e,o]);else if(a)o(e.error);else if("use"===h&&f){var l=e.baseUrl,p=e.url;e.baseUrl=f.substring(0,f.length),e.url=e.url.substring(f.length)||"",c.apply(t,[e,o]),e.baseUrl=l,e.url=p}else c.apply(t,[e,o])}}function i(){var e=!0,n=[],i={},u=function(r,i){i=i||function(){};var s=[],f=[];n.forEach(function(e){return e.checker&&!e.checker()?f.push(e):"use"!==e.type||e.uri&&r.url.indexOf(e.uri)?"get"===e.type&&t(r.url,e.uri)?s.push(e):void 0:s.push(e)}),f.forEach(function(t){n.splice(n.indexOf(t),1)}),r.boot=e,o(u,r,s,i)(r.error),e=!1};return u.exists=function(e){var r=!1;return n.forEach(function(n){if(!n.checker||n.checker()){if("get"===n.type&&t(e,n.uri))return r=!0;if("use"===n.type&&n.uri&&!e.indexOf(n.uri)){if("function"!=typeof n.fn.exists)return r=t(e,n.uri);r=n.fn.exists(e.substring(n.uri.length))}}}),r},u.use=function(t,e,o){if("function"==typeof t&&(o=e,e=t,t=null),t&&"string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("function"!=typeof e)throw new TypeError("illegal type of router:"+typeof e);return n.push({type:"use",uri:t,fn:e,checker:o||r()}),this},u.get=function(t,e,o){if("string"!=typeof t)throw new TypeError("illegal type of uri:"+typeof t);if("function"!=typeof e)throw new TypeError("illegal type of router:"+typeof e);return n.push({type:"get",uri:t,fn:e,checker:o||r()}),this},u.notfound=function(t){},u.drop=function(t){var e=[];return n.forEach(function(n){n.fn===t&&e.push(n)}),e.forEach(function(t){n.splice(n.indexOf(t),1)}),this},u.clear=function(){return n=[],this},u.on=function(t,e){return i[t]=i[t]||[],i[t].push(e),this},u.once=function(t,e){var n=function(r){return u.off(t,n),e.call(this,r)};return u.on(t,n),this},u.off=function(t,e){var n=i[t];if(n)for(var r;~(r=n.indexOf(e));)n.splice(r,1);return this},u}function u(t){if(!(this instanceof u))throw new Error("illegal state: 'new Routes()' instead of 'Routes()'");t=t||{};var r,o,f=i();this.config=function(e,n){var r=t;return 1===arguments.length?r(e):(null===n?delete r[e]:r[e]=n,this)},this.router=function(){return i()};var h;this.href=function(t){return arguments.length?(t=s(t),h===t.href?this:(e=t.href,this.exec(),this)):h||location.href},this.exec=function(){var t=s(this.href());return o=[],r={method:"get",parsed:t,url:t.href,originalUrl:t.pathname,baseUrl:"/",url:t.pathname,hashname:t.hash,query:n(t.search),hash:function(t,e){o.push({hash:t,fn:e})},params:{}},f(r,function(t){return t?console.error(t):void 0}),this},this.exechash=function(){return this},this.use=function(t,e){return f.use.apply(f,arguments),this},this.get=function(t,e){return f.get(t,e),this},this.notfound=function(t){return f.notfound(t),this},this.drop=function(t){return f.drop(t),this},this.exists=function(t){return f.exists(t)},this.clear=function(){return f.clear(),this},this.on=function(t,e){return f.on(t,e),this},this.once=function(t,e){return f.once(t,e),this},this.off=function(t,e){return f.off(t,e),this}}var s=function(t,e){var n=(e||document).createElement("a");return n.href=t,{href:t,protocol:n.protocol,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search,hash:n.hash,host:n.host}},f=function(t,e){var n=document.head.querySelector('meta[name="'+t+'"][content]');return n&&n.getAttribute("content")||e},h=document.baseURI;console.log("baseUrl",h);var c=function(){function t(t){return t.__routes_managed__||(t.__routes_managed__=!0,s(t,"click",function(e){if(t.hasAttribute("data-prevent"))return e.preventDefault();var n=t.getAttribute("href");if(n&&!~n.indexOf("://")&&n.toLowerCase().indexOf("javascript:")&&!t.getAttribute("target")&&(i||r.exists(t.pathname)))if(e.preventDefault(),"hash"===u)location.href="#"+t.href;else{if(location.href===t.href)return;history.pushState({},null,t.href)}})),this}function e(){return[].forEach.call(document.querySelectorAll("[routes], [data-routes]"),t),this}function n(){o&&o.disconnect(),o=new MutationObserver(function(e){e.forEach(function(e){[].forEach.call(e.addedNodes,function(e){1===e.nodeType&&(e.hasAttribute("routes")&&t(e),e.hasAttribute("data-routes")&&t(e),e.querySelectorAll&&[].forEach.call(e.querySelectorAll("[routes], [data-routes]"),t))})})}),o.observe(document.body,{childList:!0,subtree:!0}),e(),c.href(location.href)}if(!("onhashchange"in window))return console.error("[routes] unsupported browser");var r,o,i="true"===f("routes.always"),u=f("routes.mode")||"pushstate",s=function(t,e,n,r){t.attachEvent?t.attachEvent(e,n):t.addEventListener(e,n,r)};if(history.pushState){var h=history.pushState;history.pushState=function(t,e,n){h.apply(history,arguments),r&&r.href(location.href)},window.onpopstate=function(t){r&&r.href(location.href)}}return"onhashchange"in window&&s(window,"hashchange",function(){var t=location.hash;console.log("hash",t),r&&r.href(location.hash)}),document.body?n():s(document,"DOMContentLoaded",n),{context:function(t){return arguments.length?(r=t,this):r},href:function(t){return r&&r.href(t),this},scan:e,observer:function(){return o}}}(),a=new u;return a.Routes=u,a.trigger=c,c.context(a),a});